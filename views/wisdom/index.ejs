
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta property="qc:admins" content="01676642316411516375" />
<meta name="keywords" content="{{ lay.base.keywords }}">
<meta name="description" content="{{ lay.base.description }}">
<meta name="renderer" content="webkit">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title><%= title %></title>
<%- include("../link.ejs") %>
</head>
<body>

<%- include("../header.ejs") %>

<div class="main layui-clear">
  <div class="wrap">
    <div class="content" style="margin-right:0">
      <div class="fly-tab">

        <!-- <form action="http://cn.bing.com/search" class="fly-search">
          <i class="iconfont icon-sousuo"></i>
          <input class="layui-input" autocomplete="off" placeholder="搜索内容，回车跳转" type="text" name="q">
        </form> -->

        <div class="layui-form-item">
          <div class="layui-inline">
            <form class="layui-form" action="">
              <div class="layui-form-item">
                <label class="layui-form-label">学科分类</label>
                <div class="layui-input-inline">
                  <select name="discipline" id="disciplines" lay-filter="disciplines">
                    <option value="0">全部</option>
                    <option value="哲学">哲学</option>
                    <option value="经济学">经济学</option>
                    <option value="法学">法学</option>
                    <option value="教育学">教育学</option>
                    <option value="文学">文学</option>
                    <option value="历史学">历史学</option>
                    <option value="理学">理学</option>
                    <option value="工学">工学</option>
                    <option value="农学">农学</option>
                    <option value="医学">医学</option>
                    <option value="军事学">军事学</option>
                    <option value="管理学">管理学</option>
                    <option value="艺术学">艺术学</option>
                  </select>
                </div>
              </div>
            </from>
          </div>
          <div class="layui-inline">
            <form action="http://cn.bing.com/search" class="fly-search">
              <div class="layui-form-item">

               <div class="layui-input-inline">
              <input class="layui-input" autocomplete="off" placeholder="搜索内容，回车跳转" type="text" name="q">
              </div>
              </div>
            </form>
          </div>
        </div>


      </div>


      <ul class="fly-list" id="userlist">

        <% users.forEach(function(user){%>
                <li class="fly-list-li">
                  <a href="users/home?uid=<%= user.get('objectId') %>" class="fly-list-avatar">
                    <img src=<%= user.get('avatar') %> alt="">
                  </a>
                  <h2 class="fly-tip">
                    <a href="users/home?uid=<%= user.get('objectId') %>"><%= user.get('nickname') %></a>
                  </h2>
                  <p>
                    <span><%= user.get('d_disciplinesFields') %> ></span>
                    <span><%= user.get('d_firstDisciplines') %> ></span>
                    <span><%= user.get('d_secondDisciplines') %></span>
                    <span class="fly-list-hint">
                      <i class="iconfont" title="回答">&#xe60c;</i> <% if(user.get('d_consultCount')== undefined ){ %> 0 <% }else{ %><%= user.get('d_consultCount') %> <% } %> 咨询
                      <i class="iconfont" title="人气">&#xe60b;</i> <% if(user.get('d_follower')== undefined ){ %> 0 <% }else{ %><%= user.get('d_follower') %> <% } %> 关注
                    </span>
                  </p>
                </li>
        <% }) %>

      </ul>



      <div style="text-align: center">
        <div class="laypage-main">
          <a href="jie/index.html" class="laypage-next">更多求解</a>
        </div>
      </div>

    </div>
  </div>

</div>

<%- include("../footer.ejs") %>

<script>
layui.use(['jquery','form','layer'], function(){

  var form = layui.form()
  ,$ = layui.jquery
  ,layer = layui.layer;

  form.on('select(disciplines)', function(data){
    console.log(data.value); //得到被选中的值
    //传递一个类别，返回一个json数组
    $.post(
      "/search/usersOfSelect",
      {
        discipline: data.value,
      },
      function (data, status){
        if(data == 'success'){
          layer.msg("成功搜索");
        }else{
          $("#userlist").empty();
          var i = data.length;
          while (i--) {
            var string = '';
            string += '<li class="fly-list-li">';
            string += '<a href="users/home?uid='+ data[i].objectId +'" class="fly-list-avatar"><img src="'+ data[i].avatar +'" alt=""></a>';
            string += '<h2 class="fly-tip">';
            string += '<a href="users/home?uid='+data[i].objectId+'"> '+ data[i].nickname +' </a>';
            string += '</h2>';
            string += '<p>';
            string += '<span>'+ data[i].d_disciplinesFields +' ></span>';
            string += '<span>'+ data[i].d_firstDisciplines +' ></span>';
            string += '<span>'+ data[i].d_secondDisciplines +'</span>';
            string += '<span class="fly-list-hint">';
            if(data[i].d_consultCount===undefined) data[i].d_consultCount=0;
            string += '<i class="iconfont" title="回答">&#xe60c;</i> '+ data[i].d_consultCount +' 咨询';
            if(data[i].d_follower===undefined) data[i].d_follower=0;
            string += '<i class="iconfont" title="人气">&#xe60b;</i> '+ data[i].d_follower +' 关注';
            string += '</span>';
            string += '</p>';
            string += '</li>';
            $("#userlist").append(string);
          }

        }
      }
    )
  });

});
</script>

</body>
</html>
